(function(){var _0x1a2b='use strict';var _0x3c4d=function(){var _0x5e6f=document.querySelector('.questlog, #questlog_new, [id*="questlog"]');if(_0x5e6f){var _0x7g8h=document.createElement('div');_0x7g8h.style.cssText='margin-top: 5px; text-align: center;';var _0x9i0j=document.createElement('button');_0x9i0j.innerHTML='<img src="https://i.ibb.co/RptK4TP5/teamrocketlogo.gif" style="width: 30px; height: 30px;">';_0x9i0j.title='Daily Stats to Discord';_0x9i0j.style.cssText='width: 40px; height: 40px; background: transparent; border: none; cursor: pointer; display: inline-flex; align-items: center; justify-content: center; padding: 0;';_0x9i0j.onclick=function(_0x1k2l){_0x1k2l.preventDefault();_0x3m4n();};_0x7g8h.appendChild(_0x9i0j);_0x5e6f.appendChild(_0x7g8h);}else{var _0x5o6p=document.querySelector('#header_info');if(_0x5o6p){var _0x7q8r=document.createElement('a');_0x7q8r.href='#';_0x7q8r.innerHTML='<img src="https://i.ibb.co/RptK4TP5/teamrocketlogo.gif" style="width: 20px; height: 20px; vertical-align: middle;">';_0x7q8r.title='Daily Stats';_0x7q8r.style.cssText='margin-left: 10px; padding: 5px; background: transparent; border: none; text-decoration: none; display: inline-block;';_0x7q8r.onclick=function(_0x9s0t){_0x9s0t.preventDefault();_0x3m4n();};_0x5o6p.appendChild(_0x7q8r);}}};var _0x3m4n=function(){var _0x1u2v=document.createElement('div');_0x1u2v.style.cssText='position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 10000; display: flex; align-items: center; justify-content: center;';var _0x3w4x=document.createElement('div');_0x3w4x.style.cssText='background: #2C2F33; color: #DCDDDE; padding: 25px; border-radius: 8px; width: 550px; box-shadow: 0 8px 16px rgba(0,0,0,0.3);';_0x3w4x.innerHTML='<h2 style="margin-top: 0; color: #5865F2;">üìä Send Daily Stats to Discord</h2><div style="margin-bottom: 15px;"><label style="display: block; margin-bottom: 5px; font-weight: bold;">Discord Webhook URL:</label><input type="text" id="webhookUrl" placeholder="https://discord.com/api/webhooks/..." style="width: 100%; padding: 8px; border: 1px solid #40444B; background: #40444B; color: #DCDDDE; border-radius: 4px; box-sizing: border-box;"></div><div style="margin-bottom: 15px;"><label style="display: block; margin-bottom: 5px;"><input type="checkbox" id="autoSendEnabled" style="margin-right: 5px;"><strong>Auto-send daily at:</strong></label><input type="time" id="autoSendTime" value="23:00" disabled style="width: 100%; padding: 8px; border: 1px solid #40444B; background: #40444B; color: #DCDDDE; border-radius: 4px; box-sizing: border-box;"><p style="font-size: 12px; color: #B9BBBE; margin: 5px 0 0 0;">Leave the game open for auto-send to work</p></div><div id="statsPreview" style="background: #40444B; padding: 15px; border-radius: 4px; margin-bottom: 15px;"><p style="margin: 5px 0;"><strong>Gathering stats...</strong></p></div><div style="display: flex; gap: 10px;"><button id="sendBtn" style="flex: 1; padding: 10px; background: #5865F2; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: bold;">Send to Discord</button><button id="closeBtn" style="flex: 1; padding: 10px; background: #ED4245; color: white; border: none; border-radius: 4px; cursor: pointer; font-size: 14px; font-weight: bold;">Close</button></div><div id="statusMsg" style="margin-top: 15px; text-align: center; font-size: 14px;"></div>';_0x1u2v.appendChild(_0x3w4x);document.body.appendChild(_0x1u2v);var _0x5y6z=localStorage.getItem('tw_discord_webhook');var _0x7a8b=localStorage.getItem('tw_auto_send_enabled')==='true';var _0x9c0d=localStorage.getItem('tw_auto_send_time')||'23:00';if(_0x5y6z){document.getElementById('webhookUrl').value=_0x5y6z;}var _0x1e2f=document.getElementById('autoSendEnabled');var _0x3g4h=document.getElementById('autoSendTime');_0x1e2f.checked=_0x7a8b;_0x3g4h.value=_0x9c0d;_0x3g4h.disabled=!_0x7a8b;_0x1e2f.onchange=function(){_0x3g4h.disabled=!_0x1e2f.checked;localStorage.setItem('tw_auto_send_enabled',_0x1e2f.checked);if(_0x1e2f.checked){localStorage.setItem('tw_auto_send_time',_0x3g4h.value);_0x5i6j();}};_0x3g4h.onchange=function(){localStorage.setItem('tw_auto_send_time',_0x3g4h.value);if(_0x1e2f.checked){_0x5i6j();}};var _0x7k8l=document.getElementById('statsPreview');_0x7k8l.innerHTML='<p style="margin: 5px 0;"><strong>Loading stats...</strong></p>';_0x9m0n().then(function(_0x1o2p){var _0x3q4r='';if(Object.keys(_0x1o2p.troops).length>0){_0x3q4r='<p style="margin: 10px 0 5px 0; border-top: 1px solid #2C2F33; padding-top: 10px;"><strong>‚öîÔ∏è Total Troops at Home:</strong></p>';for(var _0x5s6t in _0x1o2p.troops){var _0x7u8v=_0x1o2p.troops[_0x5s6t];var _0x9w0x=_0x7u8v.icon?'<img src="'+_0x7u8v.icon+'" style="width: 18px; height: 18px; vertical-align: middle; margin-right: 4px;">':'';_0x3q4r+='<p style="margin: 2px 0; padding-left: 20px; font-size: 13px;">'+_0x9w0x+_0x5s6t+': '+_0x7u8v.count+'</p>';}}if(_0x1o2p.playerName&&_0x1o2p.playerName!=='Unknown'){var _0x1y2z=document.getElementById('webhookUrl').value.trim();if(_0x1y2z){var _0x3a4b=_0x1y2z.split('/').pop();var _0x5c6d='tw_player_name_'+_0x1o2p.world+'_'+_0x3a4b;localStorage.setItem(_0x5c6d,_0x1o2p.playerName);}}var _0x7e8f='';if(_0x1o2p.playerName==='Unknown'){_0x7e8f='<div style="margin: 10px 0; padding: 10px; background: #ED4245; border-radius: 4px;"><p style="margin: 0 0 5px 0; font-size: 12px; color: white;"><strong>‚ö†Ô∏è Player name not detected</strong></p><input type="text" id="manualPlayerName" placeholder="Enter your player name" style="width: 100%; padding: 6px; border: 1px solid #40444B; background: #40444B; color: #DCDDDE; border-radius: 4px; box-sizing: border-box; font-size: 13px;"></div>';}_0x7k8l.innerHTML='<p style="margin: 5px 0;"><strong>üåç World:</strong> '+_0x1o2p.world+'</p><p style="margin: 5px 0;"><strong>üë§ Player:</strong> '+_0x1o2p.playerName+'</p>'+_0x7e8f+'<p style="margin: 5px 0;"><strong>üåæ Daily Farm Total:</strong> '+_0x1o2p.farmTotal+'</p><p style="margin: 5px 0;"><strong>üì¶ Daily Resources Total:</strong> '+_0x1o2p.gatherTotal+'</p><p style="margin: 10px 0 5px 0; border-top: 1px solid #2C2F33; padding-top: 10px;"><strong>üí∞ Grand Total:</strong> '+_0x1o2p.grandTotal+'</p>'+_0x3q4r;}).catch(function(_0x9g0h){_0x7k8l.innerHTML='<p style="margin: 5px 0; color: #ED4245;"><strong>Error loading stats. Please try again.</strong></p>';console.error('Error gathering stats:',_0x9g0h);});document.getElementById('closeBtn').onclick=function(){document.body.removeChild(_0x1u2v);};document.getElementById('sendBtn').onclick=async function(){var _0x1i2j=document.getElementById('webhookUrl').value.trim();var _0x3k4l=document.getElementById('statusMsg');if(!_0x1i2j){_0x3k4l.innerHTML='<span style="color: #ED4245;">‚ùå Please enter a webhook URL</span>';return;}localStorage.setItem('tw_discord_webhook',_0x1i2j);_0x3k4l.innerHTML='<span style="color: #FEE75C;">‚è≥ Sending...</span>';var _0x5m6n=await _0x9m0n();var _0x7o8p=document.getElementById('manualPlayerName');if(_0x7o8p&&_0x7o8p.value.trim()){_0x5m6n.playerName=_0x7o8p.value.trim();var _0x9q0r=_0x1i2j.split('/').pop();var _0x1s2t='tw_player_name_'+_0x5m6n.world+'_'+_0x9q0r;localStorage.setItem(_0x1s2t,_0x5m6n.playerName);}_0x3u4v(_0x1i2j,_0x5m6n,_0x3k4l);};_0x1u2v.onclick=function(_0x5w6x){if(_0x5w6x.target===_0x1u2v){document.body.removeChild(_0x1u2v);}};};var _0xaa1b=function(_0xbb2c){if(!_0xbb2c)return 0;var _0xcc3d=_0xbb2c.replace(/\s/g,'').replace(/\./g,'').replace(/[^\d]/g,'');return parseInt(_0xcc3d)||0;};var _0xdd4e=function(_0xee5f){return _0xee5f.toLocaleString('pt-PT');};async function _0x9m0n(){var _0xff6g={farmResources:{wood:'N/A',clay:'N/A',iron:'N/A'},gatherResources:{wood:'N/A',clay:'N/A',iron:'N/A'},farmTotal:'N/A',gatherTotal:'N/A',grandTotal:'N/A',playerName:'Unknown',troops:{},world:'Unknown'};try{var _0x007h=window.location.origin+window.location.pathname;var _0x118i=new URLSearchParams(window.location.search);var _0x229j=window.location.hostname.match(/^(\w+)\./);_0xff6g.world=_0x229j?_0x229j[1].toUpperCase():'Unknown';var _0x330k=await fetch(_0x007h+'?'+_0x118i.toString()+'&screen=info_player');var _0x441l=await _0x330k.text();var _0x552m=new DOMParser().parseFromString(_0x441l,'text/html');var _0x663n=_0x552m.querySelector('td.selected a[href*="screen=info_player"]');if(_0x663n){_0xff6g.playerName=_0x663n.textContent.trim();}if(_0xff6g.playerName==='Unknown'||!_0xff6g.playerName){var _0x774o=_0x552m.querySelector('table.vis.modemenu td.selected a');if(_0x774o){_0xff6g.playerName=_0x774o.textContent.trim();}}if(_0xff6g.playerName==='Unknown'||!_0xff6g.playerName){var _0x885p=document.querySelector('#menu_row2 a[href*="screen=info_player"]:not([href*="id="])');if(_0x885p){_0xff6g.playerName=_0x885p.textContent.trim();}}if(_0xff6g.playerName==='Unknown'||!_0xff6g.playerName){var _0x996q=document.querySelector('#menu_row2');if(_0x996q){var _0xaa7r=_0x996q.querySelectorAll('a[href*="screen=info_player"]:not([href*="id="])');if(_0xaa7r.length>0){_0xff6g.playerName=_0xaa7r[0].textContent.trim();}}}var _0xbb8s=await fetch(_0x007h+'?'+_0x118i.toString()+'&screen=ranking&mode=in_a_day&type=loot_res');var _0xcc9t=await _0xbb8s.text();var _0xdd0u=new DOMParser().parseFromString(_0xcc9t,'text/html');var _0xee1v=_0xdd0u.querySelector('#content_value');if(_0xee1v){var _0xff2w=_0xee1v.textContent;var _0x003x=_0xff2w.match(/O\s+meu\s+resultado\s+de\s+hoje:\s*([\d\s\.]+)/i);if(_0x003x){var _0x114y=_0xaa1b(_0x003x[1]);_0xff6g.farmTotal=_0xdd4e(_0x114y);var _0x225z=_0xdd0u.querySelector('#in_a_day_ranking_table tr.lit, #in_a_day_ranking_table tr.lit-item');if(_0x225z){var _0x336a=_0x225z.querySelectorAll('td');if(_0x336a.length>=5){var _0x447b=_0xaa1b(_0x336a[2]?.textContent);var _0x558c=_0xaa1b(_0x336a[3]?.textContent);var _0x669d=_0xaa1b(_0x336a[4]?.textContent);_0xff6g.farmResources.wood=_0xdd4e(_0x447b);_0xff6g.farmResources.clay=_0xdd4e(_0x558c);_0xff6g.farmResources.iron=_0xdd4e(_0x669d);}}}}var _0x770e=await fetch(_0x007h+'?'+_0x118i.toString()+'&screen=ranking&mode=in_a_day&type=scavenge');var _0x881f=await _0x770e.text();var _0x992g=new DOMParser().parseFromString(_0x881f,'text/html');var _0xaa3h=_0x992g.querySelector('#content_value');if(_0xaa3h){var _0xbb4i=_0xaa3h.textContent;var _0xcc5j=_0xbb4i.match(/O\s+meu\s+resultado\s+de\s+hoje:\s*([\d\s\.]+)/i);if(_0xcc5j){var _0xdd6k=_0xaa1b(_0xcc5j[1]);_0xff6g.gatherTotal=_0xdd4e(_0xdd6k);var _0xee7l=_0x992g.querySelector('#in_a_day_ranking_table tr.lit, #in_a_day_ranking_table tr.lit-item');if(_0xee7l){var _0xff8m=_0xee7l.querySelectorAll('td');if(_0xff8m.length>=5){var _0x009n=_0xaa1b(_0xff8m[2]?.textContent);var _0x110o=_0xaa1b(_0xff8m[3]?.textContent);var _0x221p=_0xaa1b(_0xff8m[4]?.textContent);_0xff6g.gatherResources.wood=_0xdd4e(_0x009n);_0xff6g.gatherResources.clay=_0xdd4e(_0x110o);_0xff6g.gatherResources.iron=_0xdd4e(_0x221p);}}}}if(_0xff6g.gatherTotal!=='N/A'&&_0xff6g.farmTotal!=='N/A'){var _0x332q=_0xaa1b(_0xff6g.gatherTotal);var _0x443r=_0xaa1b(_0xff6g.farmTotal);_0xff6g.grandTotal=_0xdd4e(_0x332q+_0x443r);}var _0x554s=await fetch(_0x007h+'?'+_0x118i.toString()+'&screen=overview_villages&mode=units');var _0x665t=await _0x554s.text();var _0x776u=new DOMParser().parseFromString(_0x665t,'text/html');var _0x887v=_0x776u.querySelector('#units_table thead tr');var _0x998w={};var _0xaa9x='https://dspt.innogamescdn.com/asset/caf5a096/graphic/unit/';if(_0x887v){var _0xbb0y=_0x887v.querySelectorAll('th');_0xbb0y.forEach(function(_0xcc1z,_0xdd2a){var _0xee3b=_0xcc1z.querySelector('img[src*="unit"]');if(_0xee3b&&_0xee3b.src){var _0xff4c=_0xee3b.src.match(/unit_(\w+)\./);if(!_0xff4c){_0xff4c=_0xee3b.src.match(/unit\/(\w+)\./);}if(!_0xff4c){_0xff4c=_0xee3b.src.match(/unit[_\/]([^._]+)/);}if(_0xff4c){var _0x005d=_0xff4c[1];var _0x116e={'spear':'Spear','sword':'Sword','axe':'Axe','archer':'Archer','spy':'Spy','light':'Light Cav','marcher':'Mounted Archer','heavy':'Heavy Cav','ram':'Ram','catapult':'Catapult','knight':'Paladin','snob':'Noble'};if(_0x116e[_0x005d]){_0x998w[_0xdd2a]={name:_0x116e[_0x005d],icon:_0xaa9x+'unit_'+_0x005d+'.png'};}}}});}var _0x227f=_0x776u.querySelectorAll('#units_table tbody tr');var _0x338g={};var _0x449h=0;_0x227f.forEach(function(_0x550i){var _0x661j=_0x550i.querySelectorAll('td');if(_0x661j.length>0){var _0x772k=_0x661j[0].textContent.trim().toLowerCase();if(_0x772k==='na aldeia'){_0x449h++;_0x661j.forEach(function(_0x883l,_0x994m){var _0xaa5n=_0x994m+1;if(_0x998w[_0xaa5n]){var _0xbb6o=_0xaa1b(_0x883l.textContent);if(!_0x338g[_0xaa5n])_0x338g[_0xaa5n]=0;_0x338g[_0xaa5n]+=_0xbb6o;}});}}});for(var _0xcc7p in _0x338g){var _0xdd8q=_0x998w[_0xcc7p];if(_0xdd8q&&_0x338g[_0xcc7p]>0){_0xff6g.troops[_0xdd8q.name]={count:_0xdd4e(_0x338g[_0xcc7p]),icon:_0xdd8q.icon};}}console.log('Troops found:',_0xff6g.troops);}catch(_0xee9r){console.log('Error gathering stats:',_0xee9r);}return _0xff6g;}function _0x3u4v(_0xff0s,_0x001t,_0x112u){var _0x223v=[{name:'üë§ Player',value:_0x001t.playerName,inline:false},{name:'üåç World',value:_0x001t.world,inline:false},{name:'üåæ Daily Farm Total',value:_0x001t.farmTotal,inline:true},{name:'üì¶ Daily Resources Total',value:_0x001t.gatherTotal,inline:true},{name:'üí∞ Grand Total',value:_0x001t.grandTotal,inline:false}];if(Object.keys(_0x001t.troops).length>0){var _0x334w='';for(var _0x445x in _0x001t.troops){_0x334w+=_0x445x+': '+_0x001t.troops[_0x445x].count+'\n';}_0x223v.push({name:'‚öîÔ∏è Total Troops at Home',value:_0x334w.trim(),inline:false});}var _0x556y={title:'üìä Tribal Wars Daily Report',color:5814783,fields:_0x223v,timestamp:new Date().toISOString(),footer:{text:'TeamRocket Bot'}};GM_xmlhttpRequest({method:'POST',url:_0xff0s,headers:{'Content-Type':'application/json'},data:JSON.stringify({embeds:[_0x556y]}),onload:function(_0x667z){if(_0x667z.status===204){_0x112u.innerHTML='<span style="color: #57F287;">‚úÖ Successfully sent to Discord!</span>';}else{_0x112u.innerHTML='<span style="color: #ED4245;">‚ùå Error: '+_0x667z.status+'</span>';}},onerror:function(_0x778a){_0x112u.innerHTML='<span style="color: #ED4245;">‚ùå Failed to send. Check your webhook URL.</span>';}});}if(document.readyState==='loading'){document.addEventListener('DOMContentLoaded',function(){_0x3c4d();_0x5i6j();});}else{_0x3c4d();_0x5i6j();}function _0x5i6j(){var _0x889b=localStorage.getItem('tw_auto_send_enabled')==='true';var _0x990c=localStorage.getItem('tw_auto_send_time')||'23:00';var _0xaa1d=localStorage.getItem('tw_discord_webhook');if(!_0x889b||!_0xaa1d)return;var _0xbb2e=function(){var _0xcc3f=new Date();var _0xdd4g=String(_0xcc3f.getHours()).padStart(2,'0')+':'+String(_0xcc3f.getMinutes()).padStart(2,'0');var _0xee5h=localStorage.getItem('tw_last_auto_send');var _0xff6i=localStorage.getItem('tw_last_auto_send_time');var _0x007j=_0xcc3f.toDateString();if(_0xdd4g===_0x990c&&!(_0xee5h===_0x007j&&_0xff6i===_0x990c)){var _0x118k='tw_auto_send_lock';var _0x229l=localStorage.getItem(_0x118k);var _0x330m=_0x229l?parseInt(_0x229l):0;if(Date.now()<_0x330m){return;}localStorage.setItem(_0x118k,(Date.now()+30000).toString());_0x9m0n().then(function(_0x441n){if(_0x441n.playerName==='Unknown'||!_0x441n.playerName){var _0x552o=_0xaa1d.split('/').pop();var _0x663p='tw_player_name_'+_0x441n.world+'_'+_0x552o;var _0x774q=localStorage.getItem(_0x663p);if(_0x774q){_0x441n.playerName=_0x774q;}}_0x3u4v(_0xaa1d,_0x441n,{innerHTML:function(){}});localStorage.setItem('tw_last_auto_send',_0x007j);localStorage.setItem('tw_last_auto_send_time',_0x990c);localStorage.removeItem(_0x118k);});}};var _0x885r=new Date();var _0x996s=_0x885r.getMinutes();var _0xaa7t=_0x885r.getSeconds();var _0xbb8u=_0x885r.getMilliseconds();var _0xcc9v=Math.ceil(_0x996s/10)*10;var _0xdd0w=(_0xcc9v-_0x996s)%60;var _0xee1x=(_0xdd0w*60-_0xaa7t)*1000-_0xbb8u;setTimeout(function(){_0xbb2e();setInterval(_0xbb2e,600000);},_0xee1x);}})();
